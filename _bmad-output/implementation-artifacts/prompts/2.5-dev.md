# Codex Dev Prompt — Story 2.5 (Upgrade/Rollback runbook)

Source of truth:
- `_bmad-output/implementation-artifacts/2-5-docker-first-upgrade-rollback-runbook-deterministic-post-action-smoke-checklist.md`

Goal:
- Write Docker-first upgrade + rollback runbook.
- Add deterministic post-action smoke checklist (expected outcomes).
- No-leak: no secrets in docs or artifacts.

Constraints:
- Docker-first baseline only (no Kubernetes/Helm assumptions).
- Keycloak is dev fixture only; prod login assumes operator-provided OIDC.

Work:
- Update docs under `docs/installation/` (or the canonical location used by 2.4).
- Ensure ordering is explicit: pin/pull → migrate → restart → smoke.
- Rollback must state when DB restore may be required.

Verification:
- Run `make lint` to ensure repo gates stay green.
- Re-read the runbook for secret leaks and ambiguity.

Traceability:
- Create run folder `_bmad-output/implementation-artifacts/runs/<ts>-2.5/` with `report.md`, `commands.log`, `files-changed.txt`, `gates.md`.
- Update `_bmad-output/implementation-artifacts/latest.txt`, `_bmad-output/implementation-artifacts/sprint-status.yaml`, and Dev Agent Record in the story file.
