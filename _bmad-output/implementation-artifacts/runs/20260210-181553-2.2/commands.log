Run dir: _bmad-output/implementation-artifacts/runs/20260210-181553-2.2
2026-02-10T18:15:53+00:00
story/2.2-nginx-reference-edge
\n## docker compose ps
NAME                       IMAGE                              COMMAND                  SERVICE            CREATED          STATUS                    PORTS
drive-app-dev-1            drive:backend-development          "/usr/local/bin/entr‚Ä¶"   app-dev            31 minutes ago   Up 31 minutes             0.0.0.0:8071->8000/tcp, [::]:8071->8000/tcp
drive-celery-dev-1         drive:backend-development          "/usr/local/bin/entr‚Ä¶"   celery-dev         42 minutes ago   Up 42 minutes             
drive-collabora-1          collabora/code:latest              "/start-collabora-on‚Ä¶"   collabora          2 days ago       Up 5 hours (healthy)      0.0.0.0:9980->9980/tcp, [::]:9980->9980/tcp
drive-kc_postgresql-1      postgres:14.3                      "docker-entrypoint.s‚Ä¶"   kc_postgresql      31 minutes ago   Up 31 minutes (healthy)   0.0.0.0:6433->5432/tcp, [::]:6433->5432/tcp
drive-keycloak-1           quay.io/keycloak/keycloak:26.3.2   "/opt/keycloak/bin/k‚Ä¶"   keycloak           31 minutes ago   Up 31 minutes             8443/tcp, 0.0.0.0:8080->8080/tcp, [::]:8080->8080/tcp, 9000/tcp
drive-mailcatcher-1        sj26/mailcatcher:latest            "mailcatcher --foreg‚Ä¶"   mailcatcher        2 days ago       Up 5 hours                1025/tcp, 0.0.0.0:1081->1080/tcp, [::]:1081->1080/tcp
drive-nginx-1              nginx:1.25                         "/docker-entrypoint.‚Ä¶"   nginx              31 minutes ago   Up 31 minutes             80/tcp, 0.0.0.0:8083->8083/tcp, [::]:8083->8083/tcp
drive-onlyoffice-1         onlyoffice/documentserver-de       "/app/ds/run-documen‚Ä¶"   onlyoffice         5 hours ago      Up 5 hours (healthy)      443/tcp, 0.0.0.0:9981->80/tcp, [::]:9981->80/tcp
drive-postgresql-1         postgres:16                        "docker-entrypoint.s‚Ä¶"   postgresql         5 hours ago      Up 5 hours (healthy)      0.0.0.0:6434->5432/tcp, [::]:6434->5432/tcp
drive-redis-1              redis:5                            "docker-entrypoint.s‚Ä¶"   redis              2 days ago       Up 5 hours                0.0.0.0:6379->6379/tcp, [::]:6379->6379/tcp
drive-seaweedfs-filer-1    chrislusf/seaweedfs:latest         "/entrypoint.sh file‚Ä¶"   seaweedfs-filer    8 hours ago      Up 8 hours                7333/tcp, 8080/tcp, 8333/tcp, 8888/tcp, 9333/tcp, 18080/tcp, 18888/tcp, 19333/tcp
drive-seaweedfs-master-1   chrislusf/seaweedfs:latest         "/entrypoint.sh mast‚Ä¶"   seaweedfs-master   8 hours ago      Up 8 hours                7333/tcp, 8080/tcp, 8333/tcp, 8888/tcp, 9333/tcp, 18080/tcp, 18888/tcp, 19333/tcp
drive-seaweedfs-s3-1       chrislusf/seaweedfs:latest         "/entrypoint.sh s3 -‚Ä¶"   seaweedfs-s3       7 hours ago      Up 7 hours (healthy)      7333/tcp, 8080/tcp, 8888/tcp, 9333/tcp, 18080/tcp, 18888/tcp, 19333/tcp, 0.0.0.0:9000->8333/tcp, [::]:9000->8333/tcp
drive-seaweedfs-volume-1   chrislusf/seaweedfs:latest         "/entrypoint.sh volu‚Ä¶"   seaweedfs-volume   8 hours ago      Up 8 hours                7333/tcp, 8080/tcp, 8333/tcp, 8888/tcp, 9333/tcp, 18080/tcp, 18888/tcp, 19333/tcp
\n## nginx config test (before restart)
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
\n## restart nginx
 Container drive-nginx-1 Restarting 
 Container drive-nginx-1 Started 
\n## nginx config test (after restart)
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
\n## Create a public READY file item in DB + store content
17 objects imported automatically (use -v 2 for details).

Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/psycopg/cursor.py", line 117, in execute
    raise ex.with_traceback(None)
psycopg.errors.UndefinedTable: relation "drive_user" does not exist
LINE 1: SELECT 1 AS "a" FROM "drive_user" WHERE "drive_user"."id" = ...
                             ^

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/manage.py", line 15, in <module>
    execute_from_command_line(sys.argv)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/__init__.py", line 442, in execute_from_command_line
    utility.execute()
    ~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/__init__.py", line 436, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/base.py", line 416, in run_from_argv
    self.execute(*args, **cmd_options)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/base.py", line 460, in execute
    output = self.handle(*args, **options)
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/commands/shell.py", line 247, in handle
    exec(options["command"], {**globals(), **self.get_namespace(**options)})
    ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in <module>
  File "/app/.venv/lib/python3.13/site-packages/factory/base.py", line 43, in __call__
    return cls.create(**kwargs)
           ~~~~~~~~~~^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/base.py", line 539, in create
    return cls._generate(enums.CREATE_STRATEGY, kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/django.py", line 122, in _generate
    return super()._generate(strategy, params)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/base.py", line 468, in _generate
    return step.build()
           ~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 270, in build
    step.resolve(pre)
    ~~~~~~~~~~~~^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 211, in resolve
    self.attributes[field_name] = getattr(self.stub, field_name)
                                  ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 356, in __getattr__
    value = value.evaluate_pre(
        instance=self,
        step=self.__step,
        overrides=declaration.context,
    )
  File "/app/.venv/lib/python3.13/site-packages/factory/declarations.py", line 67, in evaluate_pre
    return self.evaluate(instance, step, context)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/declarations.py", line 457, in evaluate
    return step.recurse(subfactory, extra, force_sequence=force_sequence)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 228, in recurse
    return builder.build(parent_step=self, force_sequence=force_sequence)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 274, in build
    instance = self.factory_meta.instantiate(
        step=step,
        args=args,
        kwargs=kwargs,
    )
  File "/app/.venv/lib/python3.13/site-packages/factory/base.py", line 320, in instantiate
    return self.factory._create(model, *args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/django.py", line 175, in _create
    return manager.create(*args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/query.py", line 665, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/core/models.py", line 251, in save
    super().save(*args, **kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/auth/base_user.py", line 65, in save
    super().save(*args, **kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/core/models.py", line 123, in save
    self.full_clean()
    ~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/base.py", line 1664, in full_clean
    self.validate_unique(exclude=exclude)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/base.py", line 1401, in validate_unique
    errors = self._perform_unique_checks(unique_checks)
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/base.py", line 1516, in _perform_unique_checks
    if qs.exists():
       ~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/query.py", line 1298, in exists
    return self.query.has_results(using=self.db)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 674, in has_results
    return compiler.has_results()
           ~~~~~~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1591, in has_results
    return bool(self.execute_sql(SINGLE))
                ~~~~~~~~~~~~~~~~^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1623, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/.venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/app/.venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/app/.venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/psycopg/cursor.py", line 117, in execute
    raise ex.with_traceback(None)
django.db.utils.ProgrammingError: relation "drive_user" does not exist
LINE 1: SELECT 1 AS "a" FROM "drive_user" WHERE "drive_user"."id" = ...
                             ^
FILE_KEY=                             ^
\n## Create a public READY file item (clean output)
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/psycopg/cursor.py", line 117, in execute
    raise ex.with_traceback(None)
psycopg.errors.UndefinedTable: relation "drive_user" does not exist
LINE 1: SELECT 1 AS "a" FROM "drive_user" WHERE "drive_user"."id" = ...
                             ^

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<string>", line 1, in <module>
    import os; os.environ.setdefault('DJANGO_SETTINGS_MODULE','drive.settings'); import django; django.setup(); from io import BytesIO; from django.core.files.storage import default_storage; from core import factories, models; item=factories.ItemFactory(link_reach='public', type=models.ItemTypeChoices.FILE, update_upload_state=models.ItemUploadStateChoices.READY); default_storage.save(item.file_key, BytesIO(b'hello media via nginx')); print('FILE_KEY:'+item.file_key)
                                                                                                                                                                                                                                        ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/base.py", line 43, in __call__
    return cls.create(**kwargs)
           ~~~~~~~~~~^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/base.py", line 539, in create
    return cls._generate(enums.CREATE_STRATEGY, kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/django.py", line 122, in _generate
    return super()._generate(strategy, params)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/base.py", line 468, in _generate
    return step.build()
           ~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 270, in build
    step.resolve(pre)
    ~~~~~~~~~~~~^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 211, in resolve
    self.attributes[field_name] = getattr(self.stub, field_name)
                                  ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 356, in __getattr__
    value = value.evaluate_pre(
        instance=self,
        step=self.__step,
        overrides=declaration.context,
    )
  File "/app/.venv/lib/python3.13/site-packages/factory/declarations.py", line 67, in evaluate_pre
    return self.evaluate(instance, step, context)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/declarations.py", line 457, in evaluate
    return step.recurse(subfactory, extra, force_sequence=force_sequence)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 228, in recurse
    return builder.build(parent_step=self, force_sequence=force_sequence)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 274, in build
    instance = self.factory_meta.instantiate(
        step=step,
        args=args,
        kwargs=kwargs,
    )
  File "/app/.venv/lib/python3.13/site-packages/factory/base.py", line 320, in instantiate
    return self.factory._create(model, *args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/django.py", line 175, in _create
    return manager.create(*args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/query.py", line 665, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/core/models.py", line 251, in save
    super().save(*args, **kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/auth/base_user.py", line 65, in save
    super().save(*args, **kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/core/models.py", line 123, in save
    self.full_clean()
    ~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/base.py", line 1664, in full_clean
    self.validate_unique(exclude=exclude)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/base.py", line 1401, in validate_unique
    errors = self._perform_unique_checks(unique_checks)
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/base.py", line 1516, in _perform_unique_checks
    if qs.exists():
       ~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/query.py", line 1298, in exists
    return self.query.has_results(using=self.db)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 674, in has_results
    return compiler.has_results()
           ~~~~~~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1591, in has_results
    return bool(self.execute_sql(SINGLE))
                ~~~~~~~~~~~~~~~~^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1623, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/.venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/app/.venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/app/.venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/psycopg/cursor.py", line 117, in execute
    raise ex.with_traceback(None)
django.db.utils.ProgrammingError: relation "drive_user" does not exist
LINE 1: SELECT 1 AS "a" FROM "drive_user" WHERE "drive_user"."id" = ...
                             ^
FILE_KEY=
1
\n## Backend health-ish (status codes only)
backend_root=404
backend_api_root=404
backend_openapi=200
\n## Gate: backend.migrate (pre-smoke)
[1mRunning migrations[0m
 Container drive-postgresql-1 Running 
 Container drive-postgresql-1 Running 
 Container drive-onlyoffice-1 Running 
 Container drive-redis-1 Running 
 Container drive-mailcatcher-1 Running 
 Container drive-celery-dev-1 Recreate 
 Container drive-seaweedfs-master-1 Running 
 Container drive-collabora-1 Running 
 Container drive-seaweedfs-volume-1 Running 
 Container drive-seaweedfs-filer-1 Running 
 Container drive-seaweedfs-s3-1 Running 
 Container drive-celery-dev-1 Recreated 
 Container drive-seaweedfs-s3-1 Waiting 
 Container drive-celery-dev-1 Starting 
 Container drive-celery-dev-1 Started 
 Container drive-seaweedfs-s3-1 Healthy 
 Container drive-createbuckets-1 Starting 
 Container drive-createbuckets-1 Started 
 Container drive-collabora-1 Waiting 
 Container drive-onlyoffice-1 Waiting 
 Container drive-postgresql-1 Waiting 
 Container drive-postgresql-1 Healthy 
 Container drive-onlyoffice-1 Healthy 
 Container drive-collabora-1 Healthy 
 Container drive-app-dev-run-c4c9fb4392c9 Creating 
\n## Gate: backend.migrate (retry, longer timeout)
[1mRunning migrations[0m
 Container drive-postgresql-1 Running 
 Container drive-seaweedfs-master-1 Running 
 Container drive-seaweedfs-volume-1 Running 
 Container drive-redis-1 Running 
 Container drive-onlyoffice-1 Running 
 Container drive-collabora-1 Running 
 Container drive-seaweedfs-filer-1 Running 
 Container drive-postgresql-1 Running 
 Container drive-seaweedfs-s3-1 Running 
 Container drive-celery-dev-1 Running 
 Container drive-mailcatcher-1 Running 
 Container drive-seaweedfs-s3-1 Waiting 
 Container drive-seaweedfs-s3-1 Healthy 
 Container drive-createbuckets-1 Starting 
 Container drive-createbuckets-1 Started 
 Container drive-collabora-1 Waiting 
 Container drive-onlyoffice-1 Waiting 
 Container drive-postgresql-1 Waiting 
 Container drive-postgresql-1 Healthy 
 Container drive-onlyoffice-1 Healthy 
 Container drive-collabora-1 Healthy 
 Container drive-app-dev-run-81c18b97a65e Creating 
 Container drive-app-dev-run-81c18b97a65e Created 
üê≥(entrypoint) creating user running in the container...
üê≥(entrypoint) running your command: python manage.py migrate
System check identified some issues:

WARNINGS:
?: (dockerflow.health.W001) Unapplied migration admin.0001_initial
?: (dockerflow.health.W001) Unapplied migration admin.0002_logentry_remove_auto_add
?: (dockerflow.health.W001) Unapplied migration admin.0003_logentry_add_action_flag_choices
?: (dockerflow.health.W001) Unapplied migration auth.0001_initial
?: (dockerflow.health.W001) Unapplied migration auth.0002_alter_permission_name_max_length
?: (dockerflow.health.W001) Unapplied migration auth.0003_alter_user_email_max_length
?: (dockerflow.health.W001) Unapplied migration auth.0004_alter_user_username_opts
?: (dockerflow.health.W001) Unapplied migration auth.0005_alter_user_last_login_null
?: (dockerflow.health.W001) Unapplied migration auth.0006_require_contenttypes_0002
?: (dockerflow.health.W001) Unapplied migration auth.0007_alter_validators_add_error_messages
?: (dockerflow.health.W001) Unapplied migration auth.0008_alter_user_username_max_length
?: (dockerflow.health.W001) Unapplied migration auth.0009_alter_user_last_name_max_length
?: (dockerflow.health.W001) Unapplied migration auth.0010_alter_group_name_max_length
?: (dockerflow.health.W001) Unapplied migration auth.0011_update_proxy_permissions
?: (dockerflow.health.W001) Unapplied migration auth.0012_alter_user_first_name_max_length
?: (dockerflow.health.W001) Unapplied migration contenttypes.0001_initial
?: (dockerflow.health.W001) Unapplied migration contenttypes.0002_remove_content_type_name
?: (dockerflow.health.W001) Unapplied migration core.00006_create_pg_trgm_extension
?: (dockerflow.health.W001) Unapplied migration core.0001_initial
?: (dockerflow.health.W001) Unapplied migration core.0002_item_mimetype_alter_user_language
?: (dockerflow.health.W001) Unapplied migration core.0003_item_main_workspace_alter_user_language
?: (dockerflow.health.W001) Unapplied migration core.0004_item_size
?: (dockerflow.health.W001) Unapplied migration core.0005_item_description
?: (dockerflow.health.W001) Unapplied migration core.0007_item_hard_deleted_at
?: (dockerflow.health.W001) Unapplied migration core.0008_alter_item_options_and_more
?: (dockerflow.health.W001) Unapplied migration core.0009_alter_user_language
?: (dockerflow.health.W001) Unapplied migration core.0010_alter_item_upload_state
?: (dockerflow.health.W001) Unapplied migration core.0011_update_items_upload_state_value
?: (dockerflow.health.W001) Unapplied migration core.0012_item_malware_detection_info
?: (dockerflow.health.W001) Unapplied migration core.0013_active_unnaccent_postgres_extension
?: (dockerflow.health.W001) Unapplied migration core.0014_alter_user_language
?: (dockerflow.health.W001) Unapplied migration core.0015_user_claims_alter_user_language
?: (dockerflow.health.W001) Unapplied migration core.0016_alter_item_link_reach
?: (dockerflow.health.W001) Unapplied migration core.0017_alter_user_short_name
?: (dockerflow.health.W001) Unapplied migration django_ltree.0001_create_extension
?: (dockerflow.health.W001) Unapplied migration easy_thumbnails.0001_initial
?: (dockerflow.health.W001) Unapplied migration easy_thumbnails.0002_thumbnaildimensions
?: (dockerflow.health.W001) Unapplied migration malware_detection.0001_initial
?: (dockerflow.health.W001) Unapplied migration malware_detection.0002_alter_malwaredetection_parameters
?: (dockerflow.health.W001) Unapplied migration malware_detection.0003_malwaredetection_error_code_and_more
?: (dockerflow.health.W001) Unapplied migration malware_detection.0004_malwaredetection_file_hash
?: (dockerflow.health.W001) Unapplied migration rest_framework_api_key.0001_initial
?: (dockerflow.health.W001) Unapplied migration rest_framework_api_key.0002_auto_20190529_2243
?: (dockerflow.health.W001) Unapplied migration rest_framework_api_key.0003_auto_20190623_1952
?: (dockerflow.health.W001) Unapplied migration rest_framework_api_key.0004_prefix_hashed_key
?: (dockerflow.health.W001) Unapplied migration rest_framework_api_key.0005_auto_20220110_1102
?: (dockerflow.health.W001) Unapplied migration sessions.0001_initial
?: (dockerflow.health.W001) Unapplied migration sites.0001_initial
?: (dockerflow.health.W001) Unapplied migration sites.0002_alter_domain_unique
Operations to perform:
  Apply all migrations: admin, auth, contenttypes, core, django_ltree, easy_thumbnails, malware_detection, rest_framework_api_key, sessions, sites
Running migrations:
  Applying django_ltree.0001_create_extension... OK
  Applying contenttypes.0001_initial... OK
  Applying contenttypes.0002_remove_content_type_name... OK
  Applying auth.0001_initial... OK
  Applying auth.0002_alter_permission_name_max_length... OK
  Applying auth.0003_alter_user_email_max_length... OK
  Applying auth.0004_alter_user_username_opts... OK
  Applying auth.0005_alter_user_last_login_null... OK
  Applying auth.0006_require_contenttypes_0002... OK
  Applying auth.0007_alter_validators_add_error_messages... OK
  Applying auth.0008_alter_user_username_max_length... OK
  Applying auth.0009_alter_user_last_name_max_length... OK
  Applying auth.0010_alter_group_name_max_length... OK
  Applying auth.0011_update_proxy_permissions... OK
  Applying auth.0012_alter_user_first_name_max_length... OK
  Applying core.0001_initial... OK
  Applying admin.0001_initial... OK
  Applying admin.0002_logentry_remove_auto_add... OK
  Applying admin.0003_logentry_add_action_flag_choices... OK
  Applying malware_detection.0001_initial... OK
  Applying core.0002_item_mimetype_alter_user_language... OK
  Applying core.0003_item_main_workspace_alter_user_language... OK
  Applying core.0004_item_size... OK
  Applying core.0005_item_description... OK
  Applying core.00006_create_pg_trgm_extension... OK
  Applying core.0007_item_hard_deleted_at... OK
  Applying core.0008_alter_item_options_and_more... OK
  Applying core.0009_alter_user_language... OK
  Applying core.0010_alter_item_upload_state... OK
  Applying core.0011_update_items_upload_state_value... OK
  Applying core.0012_item_malware_detection_info... OK
  Applying core.0013_active_unnaccent_postgres_extension... OK
  Applying core.0014_alter_user_language... OK
  Applying core.0015_user_claims_alter_user_language... OK
  Applying core.0016_alter_item_link_reach... OK
  Applying core.0017_alter_user_short_name... OK
  Applying easy_thumbnails.0001_initial... OK
  Applying easy_thumbnails.0002_thumbnaildimensions... OK
  Applying malware_detection.0002_alter_malwaredetection_parameters... OK
  Applying malware_detection.0003_malwaredetection_error_code_and_more... OK
  Applying malware_detection.0004_malwaredetection_file_hash... OK
  Applying rest_framework_api_key.0001_initial... OK
  Applying rest_framework_api_key.0002_auto_20190529_2243... OK
  Applying rest_framework_api_key.0003_auto_20190623_1952... OK
  Applying rest_framework_api_key.0004_prefix_hashed_key... OK
  Applying rest_framework_api_key.0005_auto_20220110_1102... OK
  Applying sessions.0001_initial... OK
  Applying sites.0001_initial... OK
  Applying sites.0002_alter_domain_unique... OK
\n## Create media file item (post-migrate)
17 objects imported automatically (use -v 2 for details).

FILE_KEY:item/0c553c3e-7445-46f5-9ec3-25b5f393f020/possible.doc
FILE_KEY=item/0c553c3e-7445-46f5-9ec3-25b5f393f020/possible.doc
\n## Smoke: direct S3 access without SigV4 headers (expect 403/401)
direct_s3_http=403
\n## Smoke: /media download via Nginx (expect 200 + attachment)
HTTP/1.1 200 OK
Content-Type: application/msword
Content-Length: 21
Content-Disposition: attachment
body_sha256=1199c94f2679a8bf1a9be025043bcf36b331a79e25568d63127ddc5ab2e00d62
body_bytes=21
\n## Smoke: /media/preview via Nginx (expect 200)
HTTP/1.1 403 Forbidden
Content-Type: text/html; charset=utf-8
Content-Length: 153
preview_body_sha256=f1ce317356fbc6c45a94530a331608c510d8a1debe6da528767d44276735a919
\n## No-leak: /media-auth not reachable externally (internal)
media_auth_external_http=404
\n## Create previewable (PDF) media item
17 objects imported automatically (use -v 2 for details).

Traceback (most recent call last):
  File "/app/manage.py", line 15, in <module>
    execute_from_command_line(sys.argv)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/__init__.py", line 442, in execute_from_command_line
    utility.execute()
    ~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/__init__.py", line 436, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/base.py", line 416, in run_from_argv
    self.execute(*args, **cmd_options)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/base.py", line 460, in execute
    output = self.handle(*args, **options)
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/commands/shell.py", line 247, in handle
    exec(options["command"], {**globals(), **self.get_namespace(**options)})
    ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in <module>
  File "/app/.venv/lib/python3.13/site-packages/factory/base.py", line 43, in __call__
    return cls.create(**kwargs)
           ~~~~~~~~~~^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/base.py", line 539, in create
    return cls._generate(enums.CREATE_STRATEGY, kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/django.py", line 122, in _generate
    return super()._generate(strategy, params)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/base.py", line 468, in _generate
    return step.build()
           ~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 270, in build
    step.resolve(pre)
    ~~~~~~~~~~~~^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 211, in resolve
    self.attributes[field_name] = getattr(self.stub, field_name)
                                  ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 356, in __getattr__
    value = value.evaluate_pre(
        instance=self,
        step=self.__step,
        overrides=declaration.context,
    )
  File "/app/.venv/lib/python3.13/site-packages/factory/declarations.py", line 67, in evaluate_pre
    return self.evaluate(instance, step, context)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/declarations.py", line 457, in evaluate
    return step.recurse(subfactory, extra, force_sequence=force_sequence)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 228, in recurse
    return builder.build(parent_step=self, force_sequence=force_sequence)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/builder.py", line 274, in build
    instance = self.factory_meta.instantiate(
        step=step,
        args=args,
        kwargs=kwargs,
    )
  File "/app/.venv/lib/python3.13/site-packages/factory/base.py", line 320, in instantiate
    return self.factory._create(model, *args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/factory/django.py", line 175, in _create
    return manager.create(*args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/query.py", line 665, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/core/models.py", line 251, in save
    super().save(*args, **kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/auth/base_user.py", line 65, in save
    super().save(*args, **kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/core/models.py", line 123, in save
    self.full_clean()
    ~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/base.py", line 1679, in full_clean
    raise ValidationError(errors)
django.core.exceptions.ValidationError: {'sub': ['User with this Sub already exists.']}
\n## Smoke: /media (PDF) via Nginx (expect 200 + attachment)
HTTP/1.1 403 Forbidden
Content-Type: text/html; charset=utf-8
Content-Length: 153
pdf_body_bytes=153
\n## Smoke: /media/preview (PDF) via Nginx (expect 200, no forced attachment)
HTTP/1.1 403 Forbidden
Content-Type: text/html; charset=utf-8
Content-Length: 153
preview_pdf_body_bytes=153
\n## Debug (status only): media-auth backend endpoint
media_auth_doc=200
media_auth_doc_preview=403
media_auth_pdf=403
media_auth_pdf_preview=403
\n## Debug: LinkReachChoices
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/utils/translation/trans_real.py", line 215, in _add_installed_apps_translations
    app_configs = reversed(apps.get_app_configs())
                           ~~~~~~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/apps/registry.py", line 147, in get_app_configs
    self.check_apps_ready()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/apps/registry.py", line 138, in check_apps_ready
    raise AppRegistryNotReady("Apps aren't loaded yet.")
django.core.exceptions.AppRegistryNotReady: Apps aren't loaded yet.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "<string>", line 1, in <module>
    from lasuite.drf.models.choices import LinkReachChoices; print(LinkReachChoices.choices)
                                                             ~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/utils/functional.py", line 116, in __repr__
    return repr(self.__cast())
                ~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/utils/functional.py", line 110, in __cast
    return func(*self._args, **self._kw)
  File "/app/.venv/lib/python3.13/site-packages/django/utils/translation/__init__.py", line 96, in gettext
    return _trans.gettext(message)
           ~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/utils/translation/trans_real.py", line 378, in gettext
    _default = _default or translation(settings.LANGUAGE_CODE)
                           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/utils/translation/trans_real.py", line 291, in translation
    _translations[language] = DjangoTranslation(language)
                              ~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/utils/translation/trans_real.py", line 169, in __init__
    self._add_installed_apps_translations()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/utils/translation/trans_real.py", line 217, in _add_installed_apps_translations
    raise AppRegistryNotReady(
    ...<3 lines>...
    )
django.core.exceptions.AppRegistryNotReady: The translation infrastructure cannot be initialized before the apps registry is ready. Check that you don't make non-lazy gettext calls at import time.
\n## Debug: LinkReachChoices (via manage.py)
17 objects imported automatically (use -v 2 for details).

['restricted', 'authenticated', 'public']
\n## Debug: created PDF item fields + anonymous abilities
17 objects imported automatically (use -v 2 for details).

Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2766, in to_python
    return uuid.UUID(**{input_form: value})
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/uuid.py", line 181, in __init__
    raise ValueError('badly formed hexadecimal UUID string')
ValueError: badly formed hexadecimal UUID string

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/manage.py", line 15, in <module>
    execute_from_command_line(sys.argv)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/__init__.py", line 442, in execute_from_command_line
    utility.execute()
    ~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/__init__.py", line 436, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/base.py", line 416, in run_from_argv
    self.execute(*args, **cmd_options)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/base.py", line 460, in execute
    output = self.handle(*args, **options)
  File "/app/.venv/lib/python3.13/site-packages/django/core/management/commands/shell.py", line 247, in handle
    exec(options["command"], {**globals(), **self.get_namespace(**options)})
    ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in <module>
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/query.py", line 621, in get
    clone = self._chain() if self.query.combinator else self.filter(*args, **kwargs)
                                                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/query.py", line 1495, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/query.py", line 1513, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/query.py", line 1523, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1646, in add_q
    clause, _ = self._add_q(q_object, can_reuse)
                ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1678, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ~~~~~~~~~~~~~~~~~^
        child,
        ^^^^^^
    ...<7 lines>...
        update_join_types=update_join_types,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1588, in build_filter
    condition = self.build_lookup(lookups, col, value)
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1415, in build_lookup
    lookup = lookup_class(lhs, rhs)
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 38, in __init__
    self.rhs = self.get_prep_lookup()
               ~~~~~~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 410, in get_prep_lookup
    return super().get_prep_lookup()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 96, in get_prep_lookup
    return self.lhs.output_field.get_prep_value(self.rhs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2750, in get_prep_value
    return self.to_python(value)
           ~~~~~~~~~~~~~~^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2768, in to_python
    raise exceptions.ValidationError(
    ...<3 lines>...
    )
django.core.exceptions.ValidationError: ['‚Äú‚Äù is not a valid UUID.']
\n## Create previewable (PDF) media item (unique creator + title)
17 objects imported automatically (use -v 2 for details).

PDF_FILE_KEY:item/647f84ba-3951-4b8f-abe5-82da6d7c8545/preview.pdf
PDF_KEY=item/647f84ba-3951-4b8f-abe5-82da6d7c8545/preview.pdf
\n## Smoke: /media (PDF) via Nginx (expect 200 + attachment)
HTTP/1.1 200 OK
Content-Type: application/pdf
Content-Length: 53
Content-Disposition: attachment
pdf_body_bytes=53
\n## Smoke: /media/preview (PDF) via Nginx (expect 200, no forced attachment)
HTTP/1.1 200 OK
Content-Type: application/pdf
Content-Length: 53
preview_pdf_body_bytes=53
\n## No-leak check: nginx logs should not contain SigV4 header values
(no matches)
\n## Gate: backend.tests.media_auth (targeted)
============================= test session starts ==============================
platform linux -- Python 3.13.9, pytest-9.0.2, pluggy-1.6.0
django: version: 5.2.9, settings: drive.settings (from env), configuration: Development (from env)
rootdir: /app
configfile: pyproject.toml
plugins: cov-7.0.0, django-4.11.1, xdist-3.8.0, pyfakefs-6.0.0, icdiff-0.9, Faker-38.2.0
collected 18 items

core/tests/items/test_api_items_media_auth.py FFFFFFFFFFFFFFFFFF         [100%]

=================================== FAILURES ===================================
__________________ test_api_items_media_auth_anonymous_public __________________

    def test_api_items_media_auth_anonymous_public():
        """Anonymous users should be able to retrieve attachments linked to a public item"""
        item = factories.ItemFactory(
            link_reach="public",
            type=models.ItemTypeChoices.FILE,
            update_upload_state=models.ItemUploadStateChoices.READY,
        )
    
        default_storage.save(
            item.file_key,
            BytesIO(b"my prose"),
        )
        original_url = f"http://localhost/media/{item.file_key:s}"
        now = timezone.now()
        with freeze_time(now):
>           response = APIClient().get(
                "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
            )

core/tests/items/test_api_items_media_auth.py:39: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:00,369 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:00,369 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
_ test_api_items_media_auth_anonymous_authenticated_or_restricted[authenticated] _

reach = 'authenticated'

    @pytest.mark.parametrize("reach", ["authenticated", "restricted"])
    def test_api_items_media_auth_anonymous_authenticated_or_restricted(reach):
        """
        Anonymous users should not be allowed to retrieve attachments linked to an item
        with link reach set to authenticated or restricted.
        """
        item = factories.ItemFactory(link_reach=reach)
    
        filename = f"{uuid.uuid4()!s}.jpg"
        media_url = f"http://localhost/media/item/{item.pk!s}/{filename:s}"
    
>       response = APIClient().get(
            "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=media_url
        )

core/tests/items/test_api_items_media_auth.py:79: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:01,095 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:01,098 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
_ test_api_items_media_auth_anonymous_authenticated_or_restricted[restricted] __

reach = 'restricted'

    @pytest.mark.parametrize("reach", ["authenticated", "restricted"])
    def test_api_items_media_auth_anonymous_authenticated_or_restricted(reach):
        """
        Anonymous users should not be allowed to retrieve attachments linked to an item
        with link reach set to authenticated or restricted.
        """
        item = factories.ItemFactory(link_reach=reach)
    
        filename = f"{uuid.uuid4()!s}.jpg"
        media_url = f"http://localhost/media/item/{item.pk!s}/{filename:s}"
    
>       response = APIClient().get(
            "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=media_url
        )

core/tests/items/test_api_items_media_auth.py:79: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:01,266 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:01,268 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
___ test_api_items_media_auth_authenticated_public_or_authenticated[public] ____

reach = 'public'

    @pytest.mark.parametrize("reach", ["public", "authenticated"])
    def test_api_items_media_auth_authenticated_public_or_authenticated(reach):
        """
        Authenticated users who are not related to an item should be able to retrieve
        attachments related to an item with public or authenticated link reach.
        """
        item = factories.ItemFactory(
            link_reach=reach,
            type=models.ItemTypeChoices.FILE,
            update_upload_state=models.ItemUploadStateChoices.READY,
        )
    
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        default_storage.save(
            item.file_key,
            BytesIO(b"my prose"),
        )
    
        original_url = f"http://localhost/media/{item.file_key:s}"
        now = timezone.now()
        with freeze_time(now):
>           response = client.get(
                "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
            )

core/tests/items/test_api_items_media_auth.py:111: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:01,560 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:01,560 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
_ test_api_items_media_auth_authenticated_public_or_authenticated[authenticated] _

reach = 'authenticated'

    @pytest.mark.parametrize("reach", ["public", "authenticated"])
    def test_api_items_media_auth_authenticated_public_or_authenticated(reach):
        """
        Authenticated users who are not related to an item should be able to retrieve
        attachments related to an item with public or authenticated link reach.
        """
        item = factories.ItemFactory(
            link_reach=reach,
            type=models.ItemTypeChoices.FILE,
            update_upload_state=models.ItemUploadStateChoices.READY,
        )
    
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        default_storage.save(
            item.file_key,
            BytesIO(b"my prose"),
        )
    
        original_url = f"http://localhost/media/{item.file_key:s}"
        now = timezone.now()
        with freeze_time(now):
>           response = client.get(
                "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
            )

core/tests/items/test_api_items_media_auth.py:111: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:01,793 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:01,793 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
______________ test_api_items_media_auth_authenticated_restricted ______________

    def test_api_items_media_auth_authenticated_restricted():
        """
        Authenticated users who are not related to an item should not be allowed to
        retrieve attachments linked to an item that is restricted.
        """
        item = factories.ItemFactory(
            link_reach="restricted",
            type=models.ItemTypeChoices.FILE,
            update_upload_state=models.ItemUploadStateChoices.READY,
        )
    
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        filename = f"{uuid.uuid4()!s}.jpg"
        media_url = f"http://localhost/media/item/{item.pk!s}/{filename:s}"
    
>       response = client.get("/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=media_url)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

core/tests/items/test_api_items_media_auth.py:158: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:02,037 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:02,040 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
________________ test_api_items_media_auth_related[ready-user] _________________

via = 'user', mock_user_teams = <PropertyMock name='teams' id='125048141412544'>
upload_state = ItemUploadStateChoices.READY

    @pytest.mark.parametrize("via", VIA)
    @pytest.mark.parametrize(
        "upload_state",
        [
            models.ItemUploadStateChoices.READY,
            models.ItemUploadStateChoices.ANALYZING,
            models.ItemUploadStateChoices.FILE_TOO_LARGE_TO_ANALYZE,
        ],
    )
    def test_api_items_media_auth_related(via, mock_user_teams, upload_state):
        """
        Users who have a specific access to an item, whatever the role, should be able to
        retrieve related attachments if not pending.
        """
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        item = factories.ItemFactory(
            type=models.ItemTypeChoices.FILE,
            update_upload_state=upload_state,
        )
        if via == USER:
            factories.UserItemAccessFactory(item=item, user=user)
        elif via == TEAM:
            mock_user_teams.return_value = ["lasuite", "unknown"]
            factories.TeamItemAccessFactory(item=item, team="lasuite")
    
        default_storage.save(
            item.file_key,
            BytesIO(b"my prose"),
        )
    
        original_url = f"http://localhost/media/{item.file_key:s}"
        now = timezone.now()
        with freeze_time(now):
>           response = client.get(
                "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
            )

core/tests/items/test_api_items_media_auth.py:200: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:02,228 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:02,228 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
________________ test_api_items_media_auth_related[ready-team] _________________

via = 'team', mock_user_teams = <PropertyMock name='teams' id='125048112072416'>
upload_state = ItemUploadStateChoices.READY

    @pytest.mark.parametrize("via", VIA)
    @pytest.mark.parametrize(
        "upload_state",
        [
            models.ItemUploadStateChoices.READY,
            models.ItemUploadStateChoices.ANALYZING,
            models.ItemUploadStateChoices.FILE_TOO_LARGE_TO_ANALYZE,
        ],
    )
    def test_api_items_media_auth_related(via, mock_user_teams, upload_state):
        """
        Users who have a specific access to an item, whatever the role, should be able to
        retrieve related attachments if not pending.
        """
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        item = factories.ItemFactory(
            type=models.ItemTypeChoices.FILE,
            update_upload_state=upload_state,
        )
        if via == USER:
            factories.UserItemAccessFactory(item=item, user=user)
        elif via == TEAM:
            mock_user_teams.return_value = ["lasuite", "unknown"]
            factories.TeamItemAccessFactory(item=item, team="lasuite")
    
        default_storage.save(
            item.file_key,
            BytesIO(b"my prose"),
        )
    
        original_url = f"http://localhost/media/{item.file_key:s}"
        now = timezone.now()
        with freeze_time(now):
>           response = client.get(
                "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
            )

core/tests/items/test_api_items_media_auth.py:200: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:02,465 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:02,465 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
______________ test_api_items_media_auth_related[analyzing-user] _______________

via = 'user', mock_user_teams = <PropertyMock name='teams' id='125048112072080'>
upload_state = ItemUploadStateChoices.ANALYZING

    @pytest.mark.parametrize("via", VIA)
    @pytest.mark.parametrize(
        "upload_state",
        [
            models.ItemUploadStateChoices.READY,
            models.ItemUploadStateChoices.ANALYZING,
            models.ItemUploadStateChoices.FILE_TOO_LARGE_TO_ANALYZE,
        ],
    )
    def test_api_items_media_auth_related(via, mock_user_teams, upload_state):
        """
        Users who have a specific access to an item, whatever the role, should be able to
        retrieve related attachments if not pending.
        """
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        item = factories.ItemFactory(
            type=models.ItemTypeChoices.FILE,
            update_upload_state=upload_state,
        )
        if via == USER:
            factories.UserItemAccessFactory(item=item, user=user)
        elif via == TEAM:
            mock_user_teams.return_value = ["lasuite", "unknown"]
            factories.TeamItemAccessFactory(item=item, team="lasuite")
    
        default_storage.save(
            item.file_key,
            BytesIO(b"my prose"),
        )
    
        original_url = f"http://localhost/media/{item.file_key:s}"
        now = timezone.now()
        with freeze_time(now):
>           response = client.get(
                "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
            )

core/tests/items/test_api_items_media_auth.py:200: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:02,705 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:02,705 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
______________ test_api_items_media_auth_related[analyzing-team] _______________

via = 'team', mock_user_teams = <PropertyMock name='teams' id='125048135545728'>
upload_state = ItemUploadStateChoices.ANALYZING

    @pytest.mark.parametrize("via", VIA)
    @pytest.mark.parametrize(
        "upload_state",
        [
            models.ItemUploadStateChoices.READY,
            models.ItemUploadStateChoices.ANALYZING,
            models.ItemUploadStateChoices.FILE_TOO_LARGE_TO_ANALYZE,
        ],
    )
    def test_api_items_media_auth_related(via, mock_user_teams, upload_state):
        """
        Users who have a specific access to an item, whatever the role, should be able to
        retrieve related attachments if not pending.
        """
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        item = factories.ItemFactory(
            type=models.ItemTypeChoices.FILE,
            update_upload_state=upload_state,
        )
        if via == USER:
            factories.UserItemAccessFactory(item=item, user=user)
        elif via == TEAM:
            mock_user_teams.return_value = ["lasuite", "unknown"]
            factories.TeamItemAccessFactory(item=item, team="lasuite")
    
        default_storage.save(
            item.file_key,
            BytesIO(b"my prose"),
        )
    
        original_url = f"http://localhost/media/{item.file_key:s}"
        now = timezone.now()
        with freeze_time(now):
>           response = client.get(
                "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
            )

core/tests/items/test_api_items_media_auth.py:200: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:02,951 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:02,951 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
______ test_api_items_media_auth_related[file_too_large_to_analyze-user] _______

via = 'user', mock_user_teams = <PropertyMock name='teams' id='125048135545056'>
upload_state = ItemUploadStateChoices.FILE_TOO_LARGE_TO_ANALYZE

    @pytest.mark.parametrize("via", VIA)
    @pytest.mark.parametrize(
        "upload_state",
        [
            models.ItemUploadStateChoices.READY,
            models.ItemUploadStateChoices.ANALYZING,
            models.ItemUploadStateChoices.FILE_TOO_LARGE_TO_ANALYZE,
        ],
    )
    def test_api_items_media_auth_related(via, mock_user_teams, upload_state):
        """
        Users who have a specific access to an item, whatever the role, should be able to
        retrieve related attachments if not pending.
        """
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        item = factories.ItemFactory(
            type=models.ItemTypeChoices.FILE,
            update_upload_state=upload_state,
        )
        if via == USER:
            factories.UserItemAccessFactory(item=item, user=user)
        elif via == TEAM:
            mock_user_teams.return_value = ["lasuite", "unknown"]
            factories.TeamItemAccessFactory(item=item, team="lasuite")
    
        default_storage.save(
            item.file_key,
            BytesIO(b"my prose"),
        )
    
        original_url = f"http://localhost/media/{item.file_key:s}"
        now = timezone.now()
        with freeze_time(now):
>           response = client.get(
                "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
            )

core/tests/items/test_api_items_media_auth.py:200: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:03,195 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:03,195 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
______ test_api_items_media_auth_related[file_too_large_to_analyze-team] _______

via = 'team', mock_user_teams = <PropertyMock name='teams' id='125048135543040'>
upload_state = ItemUploadStateChoices.FILE_TOO_LARGE_TO_ANALYZE

    @pytest.mark.parametrize("via", VIA)
    @pytest.mark.parametrize(
        "upload_state",
        [
            models.ItemUploadStateChoices.READY,
            models.ItemUploadStateChoices.ANALYZING,
            models.ItemUploadStateChoices.FILE_TOO_LARGE_TO_ANALYZE,
        ],
    )
    def test_api_items_media_auth_related(via, mock_user_teams, upload_state):
        """
        Users who have a specific access to an item, whatever the role, should be able to
        retrieve related attachments if not pending.
        """
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        item = factories.ItemFactory(
            type=models.ItemTypeChoices.FILE,
            update_upload_state=upload_state,
        )
        if via == USER:
            factories.UserItemAccessFactory(item=item, user=user)
        elif via == TEAM:
            mock_user_teams.return_value = ["lasuite", "unknown"]
            factories.TeamItemAccessFactory(item=item, team="lasuite")
    
        default_storage.save(
            item.file_key,
            BytesIO(b"my prose"),
        )
    
        original_url = f"http://localhost/media/{item.file_key:s}"
        now = timezone.now()
        with freeze_time(now):
>           response = client.get(
                "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
            )

core/tests/items/test_api_items_media_auth.py:200: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:03,436 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:03,436 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
____________ test_api_items_media_auth_related_filename_with_spaces ____________

    def test_api_items_media_auth_related_filename_with_spaces():
        """
        Users who have a specific access to an item, whatever the role, should be able to
        retrieve related attachments.
        """
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        item = factories.ItemFactory(
            type=models.ItemTypeChoices.FILE,
            update_upload_state=models.ItemUploadStateChoices.READY,
        )
    
        factories.UserItemAccessFactory(item=item, user=user)
    
        filename = "image with & spaces.txt"
        key = f"item/{item.pk!s}/{filename:s}"
    
        default_storage.connection.meta.client.put_object(
            Bucket=default_storage.bucket_name,
            Key=key,
            Body=BytesIO(b"my prose"),
            ContentType="text/plain",
        )
    
        original_url = quote(f"http://localhost/media/{key:s}")
        now = timezone.now()
        with freeze_time(now):
>           response = client.get(
                "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
            )

core/tests/items/test_api_items_media_auth.py:258: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:03,676 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:03,676 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
__________________ test_api_items_media_auth_item_not_a_file ___________________

    def test_api_items_media_auth_item_not_a_file():
        """
        Users who have a specific access to an item, whatever the role, should not be able to
        retrieve related attachments if the item is not a file.
        """
    
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        item = factories.ItemFactory(type=models.ItemTypeChoices.FOLDER)
    
        factories.UserItemAccessFactory(item=item, user=user)
    
        filename = "foo.txt"
        key = f"item/{item.pk!s}/{filename:s}"
    
        original_url = quote(f"http://localhost/media/{key:s}")
>       response = client.get(
            "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
        )

core/tests/items/test_api_items_media_auth.py:305: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:03,927 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:03,930 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
____________________ test_api_items_media_auth_item_pending ____________________

    def test_api_items_media_auth_item_pending():
        """
        Users who have a specific access to an item, whatever the role, should not be able to
        retrieve related attachments if the item is not ready.
        """
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        item = factories.ItemFactory(
            type=models.ItemTypeChoices.FILE,
            upload_state=models.ItemUploadStateChoices.PENDING,
        )
        factories.UserItemAccessFactory(item=item, user=user)
    
        filename = "foo.txt"
        key = f"item/{item.pk!s}/{filename:s}"
    
        original_url = quote(f"http://localhost/media/{key:s}")
>       response = client.get(
            "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
        )

core/tests/items/test_api_items_media_auth.py:331: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:04,127 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:04,129 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
____________ test_api_items_media_auth_suspicious_item_non_creator _____________

    def test_api_items_media_auth_suspicious_item_non_creator():
        """
        Users who have a specific access to an item, whatever the role, should not be able to
        retrieve related attachments if the item is suspicious and they are not the creator.
        """
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        item = factories.ItemFactory(
            type=models.ItemTypeChoices.FILE,
            update_upload_state=models.ItemUploadStateChoices.SUSPICIOUS,
            users=[(user, models.RoleChoices.OWNER)],
        )
    
        filename = "foo.txt"
        key = f"item/{item.pk!s}/{filename:s}"
    
        original_url = quote(f"http://localhost/media/{key:s}")
>       response = client.get(
            "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
        )

core/tests/items/test_api_items_media_auth.py:357: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:04,326 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:04,330 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
______________ test_api_items_media_auth_suspicious_item_creator _______________

    def test_api_items_media_auth_suspicious_item_creator():
        """
        Users who have a specific access to an item, whatever the role, should be able to
        retrieve related attachments if the item is suspicious and they are the creator.
        """
        user = factories.UserFactory()
        client = APIClient()
        client.force_login(user)
    
        item = factories.ItemFactory(
            creator=user,
            type=models.ItemTypeChoices.FILE,
            update_upload_state=models.ItemUploadStateChoices.SUSPICIOUS,
            users=[(user, models.RoleChoices.OWNER)],
        )
    
        filename = "foo.txt"
        key = f"item/{item.pk!s}/{filename:s}"
    
        original_url = quote(f"http://localhost/media/{key:s}")
        now = timezone.now()
        with freeze_time(now):
>           response = client.get(
                "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
            )

core/tests/items/test_api_items_media_auth.py:386: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:04,616 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:04,616 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
_________________ test_api_items_media_auth_filename_with_hash _________________

    def test_api_items_media_auth_filename_with_hash():
        """Files with '#' in their filename should not cause a SignatureDoesNotMatch."""
        item = factories.ItemFactory(
            link_reach="public",
            type=models.ItemTypeChoices.FILE,
            filename="Sp√©cial #4.pdf",
            update_upload_state=models.ItemUploadStateChoices.READY,
        )
    
        default_storage.save(
            item.file_key,
            BytesIO(b"my prose"),
        )
        original_url = f"http://localhost/media/{quote(item.file_key)}"
        now = timezone.now()
        with freeze_time(now):
>           response = APIClient().get(
                "/api/v1.0/items/media-auth/", HTTP_X_ORIGINAL_URL=original_url
            )

core/tests/items/test_api_items_media_auth.py:417: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/rest_framework/test.py:292: in get
    response = super().get(path, data=data, **extra)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:209: in get
    return self.generic('GET', path, **r)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:237: in generic
    return super().generic(
.venv/lib/python3.13/site-packages/django/test/client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:289: in request
    return super().request(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/rest_framework/test.py:241: in request
    request = super().request(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/client.py:1087: in request
    self.check_exception(response)
.venv/lib/python3.13/site-packages/django/test/client.py:802: in check_exception
    raise exc_value
.venv/lib/python3.13/site-packages/django/core/handlers/exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:145: in __call__
    return self._postprocess(request, response, toolbar)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py:187: in _postprocess
    rendered = toolbar.render_toolbar()
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py:93: in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader.py:62: in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/backends/django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:172: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/test/utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/loader_tags.py:56: in render
    result = self.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:1018: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/template/base.py:979: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:116: in render
    url = self.url(context)
          ^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:113: in url
    return self.handle_simple(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/templatetags/static.py:129: in handle_simple
    return staticfiles_storage.url(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py:20: in url
    url = super().url(path, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:204: in url
    return self._url(self.stored_name, name, force)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:183: in _url
    hashed_name = hashed_name_func(*args)
                  ^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <whitenoise.storage.CompressedManifestStaticFilesStorage object at 0x71bb0c7312b0>
name = 'debug_toolbar/css/print.css'

    def stored_name(self, name):
        parsed_name = urlsplit(unquote(name))
        clean_name = parsed_name.path.strip()
        hash_key = self.hash_key(clean_name)
        cache_name = self.hashed_files.get(hash_key)
        if cache_name is None:
            if self.manifest_strict:
>               raise ValueError(
                    "Missing staticfiles manifest entry for '%s'" % clean_name
                )
E               ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'

.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py:518: ValueError
----------------------------- Captured stderr call -----------------------------
2026-02-10 18:24:04,851 django.request ERROR Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
2026-02-10 18:24:04,851 request.summary INFO 
------------------------------ Captured log call -------------------------------
ERROR    django.request:log.py:253 Internal Server Error: /api/v1.0/items/media-auth/
Traceback (most recent call last):
  File "/app/.venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 145, in __call__
    return self._postprocess(request, response, toolbar)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/middleware.py", line 187, in _postprocess
    rendered = toolbar.render_toolbar()
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/toolbar.py", line 93, in render_toolbar
    return render_to_string("debug_toolbar/base.html", context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 172, in render
    return self._render(context)
           ~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/loader_tags.py", line 56, in render
    result = self.nodelist.render(context)
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 1018, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/template/base.py", line 979, in render_annotated
    return self.render(context)
           ~~~~~~~~~~~^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 116, in render
    url = self.url(context)
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 113, in url
    return self.handle_simple(path)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/templatetags/static.py", line 129, in handle_simple
    return staticfiles_storage.url(path)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/debug_toolbar/panels/staticfiles.py", line 20, in url
    url = super().url(path, *args, **kwargs)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 204, in url
    return self._url(self.stored_name, name, force)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 183, in _url
    hashed_name = hashed_name_func(*args)
  File "/app/.venv/lib/python3.13/site-packages/django/contrib/staticfiles/storage.py", line 518, in stored_name
    raise ValueError(
        "Missing staticfiles manifest entry for '%s'" % clean_name
    )
ValueError: Missing staticfiles manifest entry for 'debug_toolbar/css/print.css'
INFO     request.summary:middleware.py:82
=============================== warnings summary ===============================
.venv/lib/python3.13/site-packages/django/conf/__init__.py:190
  /app/.venv/lib/python3.13/site-packages/django/conf/__init__.py:190: RemovedInDjango60Warning: The FORMS_URLFIELD_ASSUME_HTTPS transitional setting is deprecated.
    warnings.warn(

.venv/lib/python3.13/site-packages/_pytest/cacheprovider.py:475
  /app/.venv/lib/python3.13/site-packages/_pytest/cacheprovider.py:475: PytestCacheWarning: cache could not write path /app/.pytest_cache/v/cache/nodeids: [Errno 13] Permission denied: '/app/.pytest_cache/v/cache/nodeids'
    config.cache.set("cache/nodeids", sorted(self.cached_nodeids))

.venv/lib/python3.13/site-packages/_pytest/cacheprovider.py:429
  /app/.venv/lib/python3.13/site-packages/_pytest/cacheprovider.py:429: PytestCacheWarning: cache could not write path /app/.pytest_cache/v/cache/lastfailed: [Errno 13] Permission denied: '/app/.pytest_cache/v/cache/lastfailed'
    config.cache.set("cache/lastfailed", self.lastfailed)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_anonymous_public
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_anonymous_authenticated_or_restricted[authenticated]
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_anonymous_authenticated_or_restricted[restricted]
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_authenticated_public_or_authenticated[public]
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_authenticated_public_or_authenticated[authenticated]
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_authenticated_restricted
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_related[ready-user]
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_related[ready-team]
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_related[analyzing-user]
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_related[analyzing-team]
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_related[file_too_large_to_analyze-user]
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_related[file_too_large_to_analyze-team]
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_related_filename_with_spaces
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_item_not_a_file
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_item_pending
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_suspicious_item_non_creator
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_suspicious_item_creator
FAILED core/tests/items/test_api_items_media_auth.py::test_api_items_media_auth_filename_with_hash
======================== 18 failed, 3 warnings in 5.99s ========================
\n## Gate: backend.tests.media_auth (via bin/pytest, DJANGO_CONFIGURATION=Test)
üôã(user) ID: 0
üê≥(compose) project, file: '/root/Apoze/drive/compose.yaml'
 Container drive-collabora-1 Running 
 Container drive-postgresql-1 Running 
 Container drive-redis-1 Running 
 Container drive-seaweedfs-master-1 Running 
 Container drive-onlyoffice-1 Running 
 Container drive-mailcatcher-1 Running 
 Container drive-celery-dev-1 Recreate 
 Container drive-seaweedfs-volume-1 Running 
 Container drive-seaweedfs-filer-1 Running 
 Container drive-seaweedfs-s3-1 Running 
 Container drive-celery-dev-1 Recreated 
 Container drive-celery-dev-1 Starting 
 Container drive-seaweedfs-s3-1 Waiting 
 Container drive-celery-dev-1 Started 
 Container drive-seaweedfs-s3-1 Healthy 
 Container drive-createbuckets-1 Starting 
 Container drive-createbuckets-1 Started 
 Container drive-collabora-1 Waiting 
 Container drive-onlyoffice-1 Waiting 
 Container drive-postgresql-1 Waiting 
 Container drive-postgresql-1 Healthy 
 Container drive-onlyoffice-1 Healthy 
 Container drive-collabora-1 Healthy 
 Container drive-app-dev-run-4e0782c387e3 Creating 
 Container drive-app-dev-run-4e0782c387e3 Created 
üê≥(entrypoint) creating user running in the container...
üê≥(entrypoint) running your command: pytest core/tests/items/test_api_items_media_auth.py -q
Traceback (most recent call last):
  File "/app/.venv/bin/pytest", line 10, in <module>
    sys.exit(console_main())
             ~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 223, in console_main
    code = main()
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 193, in main
    config = _prepareconfig(new_args, plugins)
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 361, in _prepareconfig
    config: Config = pluginmanager.hook.pytest_cmdline_parse(
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pluginmanager=pluginmanager, args=args
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    raise exception
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    teardown.throw(exception)
    ~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/helpconfig.py", line 124, in pytest_cmdline_parse
    config = yield
             ^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 1186, in pytest_cmdline_parse
    self.parse(args)
    ~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 1556, in parse
    self.hook.pytest_load_initial_conftests(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        early_config=self, args=args, parser=self._parser
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    raise exception
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    teardown.throw(exception)
    ~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/warnings.py", line 128, in pytest_load_initial_conftests
    return (yield)
            ^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    teardown.throw(exception)
    ~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 173, in pytest_load_initial_conftests
    yield
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
  File "/app/.venv/lib/python3.13/site-packages/pytest_django/plugin.py", line 357, in pytest_load_initial_conftests
    dj_settings.DATABASES  # noqa: B018
    ^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/conf/__init__.py", line 81, in __getattr__
    self._setup(name)
    ~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/conf/__init__.py", line 68, in _setup
    self._wrapped = Settings(settings_module)
                    ~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/conf/__init__.py", line 166, in __init__
    mod = importlib.import_module(self.SETTINGS_MODULE)
  File "/usr/local/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 919, in _load_unlocked
  File "<frozen importlib._bootstrap>", line 879, in _load_backward_compatible
  File "/app/.venv/lib/python3.13/site-packages/configurations/importer.py", line 182, in load_module
    reraise(err, "Couldn't setup configuration '{0}'".format(cls_path))
    ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/configurations/utils.py", line 65, in reraise
    raise exc
  File "/app/.venv/lib/python3.13/site-packages/configurations/importer.py", line 179, in load_module
    cls.post_setup()
    ~~~~~~~~~~~~~~^^
  File "/app/drive/settings.py", line 1744, in post_setup
    cls.WOPI_SRC_BASE_URL = _validate_public_surface_base_url(
                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        cls.WOPI_SRC_BASE_URL,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        allow_insecure_http=allow_insecure_http,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/drive/settings.py", line 82, in _validate_public_surface_base_url
    raise ValueError(
    ...<3 lines>...
    ) from None
ValueError: Couldn't setup configuration 'drive.settings.Test':  Invalid WOPI_SRC_BASE_URL configuration. failure_class=config.public_url.https_required next_action_hint=Use https:// for WOPI_SRC_BASE_URL, or for local/dev explicitly set DRIVE_ALLOW_INSECURE_HTTP=true while running with DEBUG=true. 

\n## Gate: backend.tests.media_auth (Test config; allow insecure http for local)
 Container drive-mailcatcher-1 Running 
 Container drive-seaweedfs-master-1 Running 
 Container drive-redis-1 Running 
 Container drive-collabora-1 Running 
 Container drive-seaweedfs-volume-1 Running 
 Container drive-celery-dev-1 Recreate 
 Container drive-seaweedfs-filer-1 Running 
 Container drive-postgresql-1 Running 
 Container drive-onlyoffice-1 Running 
 Container drive-seaweedfs-s3-1 Running 
 Container drive-celery-dev-1 Recreated 
 Container drive-celery-dev-1 Starting 
 Container drive-seaweedfs-s3-1 Waiting 
 Container drive-celery-dev-1 Started 
 Container drive-seaweedfs-s3-1 Healthy 
 Container drive-createbuckets-1 Starting 
 Container drive-createbuckets-1 Started 
 Container drive-collabora-1 Waiting 
 Container drive-onlyoffice-1 Waiting 
 Container drive-postgresql-1 Waiting 
 Container drive-postgresql-1 Healthy 
 Container drive-onlyoffice-1 Healthy 
 Container drive-collabora-1 Healthy 
 Container drive-app-dev-run-b1a450ab4d41 Creating 
 Container drive-app-dev-run-b1a450ab4d41 Created 
üê≥(entrypoint) creating user running in the container...
üê≥(entrypoint) running your command: pytest core/tests/items/test_api_items_media_auth.py -q
Traceback (most recent call last):
  File "/app/.venv/bin/pytest", line 10, in <module>
    sys.exit(console_main())
             ~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 223, in console_main
    code = main()
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 193, in main
    config = _prepareconfig(new_args, plugins)
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 361, in _prepareconfig
    config: Config = pluginmanager.hook.pytest_cmdline_parse(
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pluginmanager=pluginmanager, args=args
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    raise exception
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    teardown.throw(exception)
    ~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/helpconfig.py", line 124, in pytest_cmdline_parse
    config = yield
             ^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 1186, in pytest_cmdline_parse
    self.parse(args)
    ~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 1556, in parse
    self.hook.pytest_load_initial_conftests(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        early_config=self, args=args, parser=self._parser
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    raise exception
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    teardown.throw(exception)
    ~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/warnings.py", line 128, in pytest_load_initial_conftests
    return (yield)
            ^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    teardown.throw(exception)
    ~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 173, in pytest_load_initial_conftests
    yield
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
  File "/app/.venv/lib/python3.13/site-packages/pytest_django/plugin.py", line 357, in pytest_load_initial_conftests
    dj_settings.DATABASES  # noqa: B018
    ^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/conf/__init__.py", line 81, in __getattr__
    self._setup(name)
    ~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/conf/__init__.py", line 68, in _setup
    self._wrapped = Settings(settings_module)
                    ~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/conf/__init__.py", line 166, in __init__
    mod = importlib.import_module(self.SETTINGS_MODULE)
  File "/usr/local/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 919, in _load_unlocked
  File "<frozen importlib._bootstrap>", line 879, in _load_backward_compatible
  File "/app/.venv/lib/python3.13/site-packages/configurations/importer.py", line 182, in load_module
    reraise(err, "Couldn't setup configuration '{0}'".format(cls_path))
    ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/configurations/utils.py", line 65, in reraise
    raise exc
  File "/app/.venv/lib/python3.13/site-packages/configurations/importer.py", line 179, in load_module
    cls.post_setup()
    ~~~~~~~~~~~~~~^^
  File "/app/drive/settings.py", line 1744, in post_setup
    cls.WOPI_SRC_BASE_URL = _validate_public_surface_base_url(
                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        cls.WOPI_SRC_BASE_URL,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        allow_insecure_http=allow_insecure_http,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/drive/settings.py", line 82, in _validate_public_surface_base_url
    raise ValueError(
    ...<3 lines>...
    ) from None
ValueError: Couldn't setup configuration 'drive.settings.Test':  Invalid WOPI_SRC_BASE_URL configuration. failure_class=config.public_url.https_required next_action_hint=Use https:// for WOPI_SRC_BASE_URL, or for local/dev explicitly set DRIVE_ALLOW_INSECURE_HTTP=true while running with DEBUG=true. 

\n## Gate: backend.tests.media_auth (Test config; force https WOPI_SRC_BASE_URL)
 Container drive-redis-1 Running 
 Container drive-onlyoffice-1 Running 
 Container drive-postgresql-1 Running 
 Container drive-seaweedfs-master-1 Running 
 Container drive-seaweedfs-volume-1 Running 
 Container drive-collabora-1 Running 
 Container drive-seaweedfs-filer-1 Running 
 Container drive-mailcatcher-1 Running 
 Container drive-seaweedfs-s3-1 Running 
 Container drive-celery-dev-1 Recreate 
 Container drive-celery-dev-1 Recreated 
 Container drive-seaweedfs-s3-1 Waiting 
 Container drive-celery-dev-1 Starting 
 Container drive-celery-dev-1 Started 
 Container drive-seaweedfs-s3-1 Healthy 
 Container drive-createbuckets-1 Starting 
 Container drive-createbuckets-1 Started 
 Container drive-onlyoffice-1 Waiting 
 Container drive-postgresql-1 Waiting 
 Container drive-collabora-1 Waiting 
 Container drive-postgresql-1 Healthy 
 Container drive-onlyoffice-1 Healthy 
 Container drive-collabora-1 Healthy 
 Container drive-app-dev-run-5aad13d6d4ed Creating 
 Container drive-app-dev-run-5aad13d6d4ed Created 
üê≥(entrypoint) creating user running in the container...
üê≥(entrypoint) running your command: pytest core/tests/items/test_api_items_media_auth.py -q
Traceback (most recent call last):
  File "/app/.venv/bin/pytest", line 10, in <module>
    sys.exit(console_main())
             ~~~~~~~~~~~~^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 223, in console_main
    code = main()
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 193, in main
    config = _prepareconfig(new_args, plugins)
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 361, in _prepareconfig
    config: Config = pluginmanager.hook.pytest_cmdline_parse(
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pluginmanager=pluginmanager, args=args
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    raise exception
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    teardown.throw(exception)
    ~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/helpconfig.py", line 124, in pytest_cmdline_parse
    config = yield
             ^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 1186, in pytest_cmdline_parse
    self.parse(args)
    ~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 1556, in parse
    self.hook.pytest_load_initial_conftests(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        early_config=self, args=args, parser=self._parser
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    raise exception
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    teardown.throw(exception)
    ~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/warnings.py", line 128, in pytest_load_initial_conftests
    return (yield)
            ^^^^^
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    teardown.throw(exception)
    ~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 173, in pytest_load_initial_conftests
    yield
  File "/app/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
  File "/app/.venv/lib/python3.13/site-packages/pytest_django/plugin.py", line 357, in pytest_load_initial_conftests
    dj_settings.DATABASES  # noqa: B018
    ^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/conf/__init__.py", line 81, in __getattr__
    self._setup(name)
    ~~~~~~~~~~~^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/conf/__init__.py", line 68, in _setup
    self._wrapped = Settings(settings_module)
                    ~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/django/conf/__init__.py", line 166, in __init__
    mod = importlib.import_module(self.SETTINGS_MODULE)
  File "/usr/local/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 919, in _load_unlocked
  File "<frozen importlib._bootstrap>", line 879, in _load_backward_compatible
  File "/app/.venv/lib/python3.13/site-packages/configurations/importer.py", line 182, in load_module
    reraise(err, "Couldn't setup configuration '{0}'".format(cls_path))
    ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.13/site-packages/configurations/utils.py", line 65, in reraise
    raise exc
  File "/app/.venv/lib/python3.13/site-packages/configurations/importer.py", line 179, in load_module
    cls.post_setup()
    ~~~~~~~~~~~~~~^^
  File "/app/drive/settings.py", line 1756, in post_setup
    cls.OIDC_REDIRECT_ALLOWED_HOSTS = _normalize_oidc_redirect_allowed_hosts(
                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        cls.OIDC_REDIRECT_ALLOWED_HOSTS,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        allow_insecure_http=allow_insecure_http,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/drive/settings.py", line 121, in _normalize_oidc_redirect_allowed_hosts
    raise ValueError(
    ...<3 lines>...
    ) from None
ValueError: Couldn't setup configuration 'drive.settings.Test':  Invalid OIDC_REDIRECT_ALLOWED_HOSTS configuration. failure_class=config.allowlist.origin.https_required next_action_hint=Use https:// for OIDC_REDIRECT_ALLOWED_HOSTS, or for local/dev explicitly set DRIVE_ALLOW_INSECURE_HTTP=true while running with DEBUG=true. 

\n## Gate: backend.tests.media_auth (Test config; override http-only env vars)
 Container drive-redis-1 Running 
 Container drive-seaweedfs-master-1 Running 
 Container drive-celery-dev-1 Running 
 Container drive-seaweedfs-volume-1 Running 
 Container drive-onlyoffice-1 Running 
 Container drive-postgresql-1 Running 
 Container drive-seaweedfs-filer-1 Running 
 Container drive-mailcatcher-1 Running 
 Container drive-collabora-1 Running 
 Container drive-seaweedfs-s3-1 Running 
 Container drive-seaweedfs-s3-1 Waiting 
 Container drive-seaweedfs-s3-1 Healthy 
 Container drive-createbuckets-1 Starting 
 Container drive-createbuckets-1 Started 
 Container drive-collabora-1 Waiting 
 Container drive-onlyoffice-1 Waiting 
 Container drive-postgresql-1 Waiting 
 Container drive-postgresql-1 Healthy 
 Container drive-collabora-1 Healthy 
 Container drive-onlyoffice-1 Healthy 
 Container drive-app-dev-run-972782a76091 Creating 
 Container drive-app-dev-run-972782a76091 Created 
üê≥(entrypoint) creating user running in the container...
üê≥(entrypoint) running your command: pytest core/tests/items/test_api_items_media_auth.py -q
============================= test session starts ==============================
platform linux -- Python 3.13.9, pytest-9.0.2, pluggy-1.6.0
django: version: 5.2.9, settings: drive.settings (from env), configuration: Test (from env)
rootdir: /app
configfile: pyproject.toml
plugins: cov-7.0.0, django-4.11.1, xdist-3.8.0, pyfakefs-6.0.0, icdiff-0.9, Faker-38.2.0
collected 18 items

core/tests/items/test_api_items_media_auth.py ..................         [100%]

=============================== warnings summary ===============================
.venv/lib/python3.13/site-packages/django/conf/__init__.py:190
  /app/.venv/lib/python3.13/site-packages/django/conf/__init__.py:190: RemovedInDjango60Warning: The FORMS_URLFIELD_ASSUME_HTTPS transitional setting is deprecated.
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================== 18 passed, 1 warning in 2.53s =========================
\n## No-leak scan: ensure run artifacts do not contain SigV4 values
(no matches)
\n## git diff summary
 .../development/etc/nginx/conf.d/default.conf      | 49 ++++++++++++++-------
 .../files/production/etc/nginx/conf.d/default.conf | 51 ++++++++++++++++++----
 src/nginx/servers.conf.erb                         | 49 ++++++++++++++-------
 3 files changed, 110 insertions(+), 39 deletions(-)
\n## git diff name-only
docker/files/development/etc/nginx/conf.d/default.conf
docker/files/production/etc/nginx/conf.d/default.conf
src/nginx/servers.conf.erb
3 _bmad-output/implementation-artifacts/runs/20260210-181553-2.2/files-changed.txt
total 344
drwxr-xr-x  2 root root   4096 f√©vr. 10 18:29 .
drwxr-xr-x 16 root root   4096 f√©vr. 10 18:15 ..
-rw-r--r--  1 root root 327579 f√©vr. 10 18:28 commands.log
-rw-r--r--  1 root root    136 f√©vr. 10 18:28 files-changed.txt
-rw-r--r--  1 root root   1101 f√©vr. 10 18:29 gates.md
-rw-r--r--  1 root root   1482 f√©vr. 10 18:29 report.md
# sanity append
